<html>
<head>
<title>Algol 68 Genie - An Algol 68 interpreter</title>
<meta name="Keywords" content="algol,algol68,68,algol-68,algol68g,algol68-g,a68g,a68-g,68g,genie,interpreter">
<meta http-equiv="Content-Style-Type" content="text/css"; charset=ISO-8859-1">
<style type="text/css">
a:link    {color: blue; text-decoration: underline;}
a:visited {color: blue; text-decoration: underline;}
a:active  {color: blue; text-decoration: underline;}
p {font-size: 10pt; font-family: Arial,Helvetica;}
u {font-size: 10pt; font-family: Arial,Helvetica;}
dd {font-size: 10pt; font-family: Arial,Helvetica;}
h1 {font-size: 16pt; font-family: Arial,Helvetica;}
h2 {font-size: 14pt; font-family: Arial,Helvetica;}
h3 {font-size: 12pt; font-family: Arial,Helvetica;}
h4 {font-size: 10pt; font-family: Arial,Helvetica;}
td {font-size: 8pt; font-family: Arial,Helvetica;}
ul {font-size: 10pt; font-family: Arial,Helvetica;}
body {font-size: 10pt; font-family: Arial,Helvetica;}
code {font-size: 10pt; font-family: Courier;}
pre {font-size: 10pt; font-family: Courier;}
</style>
</head>

<body bgcolor="white">

<table width="100%" border=0 cellspacing=0 cellpadding=0>
<td width="100%" background="lines.gif">
<img src="lines.gif" align=right>
<small>Documentation for Algol 68 Genie Mark 9.2</small>
</td>
</table>

<table width="100%" border=0 cellspacing=0 cellpadding=0>
<td width="50%" valign=top bgcolor="white">
<br>
<h2>Example: dining persons problem</h2>
</td>
<td width="30%" valign=top bgcolor="white">
<img src="logo.gif">
</td>
<td width="5%" valign=top bgcolor="white">
</td>
<td width="15%" valign=top bgcolor="white">
<!-- Navigation bar -->
<table border="0" cellspacing="0" width="100%">
<tr>
<td background="lines.gif">
<small><b>Algol68G Mark 9.2</b></small>
<br>
&nbsp;&middot;&nbsp;<a href="introduction.html"><small>Introduction</small></a><br>
&nbsp;&middot;&nbsp;<a href="install.html"><small>Installation</small></a><br>
&nbsp;&middot;&nbsp;<a href="description.html"><small>Description</small></a><br>
&nbsp;&middot;&nbsp;<a href="examples.html"><small>Example&nbsp;programs</small></a><br>
&nbsp;&middot;&nbsp;<a href="synopsis.html"><small>Synopsis</small></a><br>
&nbsp;&middot;&nbsp;<a href="syntax.html"><small>Syntax</small></a><br>
&nbsp;&middot;&nbsp;<a href="environ.html"><small>Environment</small></a><br>
<br>
<small><b>Extensions</b></small>
<br>
&nbsp;&middot;&nbsp;<a href="extensions.html"><small>UNIX</small></a><br>
&nbsp;&middot;&nbsp;<a href="postgresql.html"><small>PostgreSQL</small></a><br>
&nbsp;&middot;&nbsp;<a href="drawing.html"><small>Drawing</small></a><br>
&nbsp;&middot;&nbsp;<a href="numerical.html"><small>Numerical</small></a><br>
<br>
&nbsp;&middot;&nbsp;<a href="contents.html"><small>Contents</small></a><br>
&nbsp;&middot;&nbsp;<a href="resources.html"><small>A68 Resources</small></a><br>
&nbsp;&middot;&nbsp;<a href="introduction.html#obtaining"><small>Downloads</small></a><br>
&nbsp;&middot;&nbsp;<a href="introduction.html#contact"><small>Contact</small></a>
</td>
</tr>
</table>
<!-- End navigation bar -->
</td>
</table>

<font color=black>
<pre>
# 
Dining persons problem, analogous to the "dining philosophers problem".

`N' persons sit at a round table with a bowl of spaghetti. 
There are `N' forks, one between each pair of persons.
To eat spaghetti, a person needs two forks, so not everybody can eat at
the same time. This program synchronises their actions.
#

MODE PERSON = INT;

INT persons = 10, idle = 0, try = 1, eat = 2, meal tickets = 2;

[persons] INT action, [persons] SEMA person;

FOR i TO persons
DO action[i] := idle;
   person[i] := LEVEL 0
OD;

SEMA mutex = LEVEL 1; # to synchronise access to `action' #

PROC put at table = (PERSON i) VOID:
     IF i > 0
     THEN PAR BEGIN put at table (i - 1),
                    (PROC do eat  = (PERSON i) VOID: print ((i, " eats")),
                          do idle = (PERSON i) VOID: print ((i, " is not eating"));
                     TO meal tickets
                     DO OP LEFT  = (PERSON i) PERSON: 1 + (i - 1) %* persons,
                           RIGHT = (PERSON i) PERSON: 1 + (i + 1) %* persons;

                        PROC try eat = (PERSON i) VOID:
                             IF action[i] = try ANDF 
                                (action[LEFT i] ~= eat ANDF action[RIGHT i] ~= eat)
                             THEN action[i] := eat;
                                  UP person[i]
                             FI;

                        do idle (i);
                        # Try to eat #
                        DOWN mutex;
                        action[i] := try;
                        try eat (i);
                        UP mutex;
                        # Eat when we can #
                        DOWN person [i];
                        do eat (i);
                        # Stop eating #
                        DOWN mutex;
                        action[i] := idle;
                        try eat (LEFT i);
                        try eat (RIGHT i);
                        UP mutex
                     OD;
                     do idle (i)
                    )
              END
     FI;

put at table (persons)
</pre>
</font>

<p>
<br>
<table width="100%" border=0 cellspacing=0 cellpadding=0>
<td width="50%" valign=top bgcolor="white">
<font color="black">
<small>Copyright &copy; 2001-2006 J. Marcel van der Veer.</small>
</font>
</td>
<td width="50%" align=right valign=top bgcolor="white">
<font color="black">
<small>Documentation for Algol 68 Genie Mark 9.2 (July 2006)</small>
</font>
</td>
</table>
</p>

</body>
</html>
