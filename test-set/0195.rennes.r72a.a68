COMMENT

This program is part of the Algol 68 Genie test.

The test set contains programs from the 
   "Revised Mathematisch Centrum Algol 68 Test Set" [1979] 
and synthetic programs from the 
   "Rennes test set" [1975].
These test sets are available from:
   www.dickgrune.com/CS/Algol68
or from the Vrije Universiteit Amsterdam:
   ftp://ftp.cs.vu.nl/pub/dick/Algol68

Above two test sets were used in the 1980's to validate the ALGOL68RS compilers [Algol Bulletin 49.2]. 

The "Rennes test-set" programs are automatically generated from the Algol 68 grammar using a formalism from Bernard Houssais (Universite de Rennes).  Especially the "Rennes test set" has proven very effective in exposing problems in Algol 68 implementations.  All programs are converted to upper-stropping and reformatted for lay-out.

The "Revised Mathematisch Centrum test set" programs are not synthetic like those in the "Rennes test set", but are selected programmer-made applications that are distributed with Algol 68 Genie with kind permission of the author of this test set, Dick Grune.

Note that part of the programs in this test set will fail; most due to intentional (syntactic or runtime) errors and a few due to differences between Algol 68 Genie and revised Algol 68. 

COMMENT

PR regression PR

# r72a #
(print(("identification a : identifiers from :",
newline,"identity declaration,variable,case on union,loop index",
newline)) ;
 INT  nbcas = 9 ;
 INT  vf = 11*(48+5*nbcas) ;
 INT  ctr:=0 , ctrt ;
 MODE   M = STRUCT ( CHAR  c, INT  de) ,
        UNE  =  UNION ( STRING , INT ) ;

# procedures de controle #
 PROC  ce = ( INT  a,b) VOID  : (a=b|ctr+:=1|
        print(("test n0",ctrt," error :",a,b,newline))) ;
 PROC  t = ( M  de, INT  vrai) VOID  : ce(de OF de,vrai) ;

# declarations de servitude #
 INT  valk:=0-1 ,
[] UNE  rune=("vide","",1, SKIP ) ;
 OP  - =( UNE  a) INT  : (a|( STRING ):0 , ( INT  a) : 0-a ) ,
 STRUCT ( UNE  deux, STRUCT ( UNE  de)de)de := (0,
    ( STRUCT ( UNE  de) of;de OF of:=rune[2];of)) ;

# declarations et tests initiaux #

   # bloc  0 #
   M  j=("m", 109) ;  M  i=("m", 108) ;  M  h:=("m", 107) ;  M  g=("m", 106) ;
 M  f=("m", 105) ;  M  e=("m", 104) ;  M  d=("m", 103) ;  M  c:=("m", 102) ;
 M  b=("m", 101) ;  M  a:=("m", 100) ;
   INT  k = 999 ;
  ctrt:=   1
  ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105) ; t(e,
 104) ; t(d, 103) ; t(c, 102) ; t(b, 101) ; t(a,100)
  ; IF 
     # bloc  1 #
     M  b=("m", 111) ;  M  c:=("m", 112);
    ctrt:=   2
    ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105) ; t(
e, 104) ; t(d, 103) ; t(c, 112) ; t(b, 111) ; t(a,100)
    ; FALSE   THEN   SKIP 
     ELIF 
       # bloc  2 #  UNE  declident = (
         # bloc  3 #
         M  c=("m", 122) ;  M  d:=("m", 123);
        ctrt:=   3
        ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105
) ; t(e, 104) ; t(d, 123) ; t(c, 122) ; t(b, 111) ; t(a,100)
         # fin  3 #
      ;"") ;
              UNE  declvariable := (
         # bloc  3 #
         M  c=("m", 222) ;  M  d:=("m", 223);
        ctrt:=   4
        ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105
) ; t(e, 104) ; t(d, 223) ; t(c, 222) ; t(b, 111) ; t(a,100)
        ;(
           # bloc  4 #
           M  d=("m", 233) ;  M  e:=("m", 234);
          ctrt:=   5
          ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105
) ; t(e, 234) ; t(d, 233) ; t(c, 222) ; t(b, 111) ; t(a,100)
           # fin  4 #
        ;"") # fin  3 #
      ) ;
       M  c=("m", 322) ;  M  d:=("m", 323);
      ctrt:=   6
      ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105) ;
t(e, 104) ; t(d, 323) ; t(c, 322) ; t(b, 111) ; t(a,100)
      ; TRUE   THEN 
         # bloc  3 #
        ctrt:=   7
        ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105
) ; t(e, 104) ; t(d, 323) ; t(c, 322) ; t(b, 111) ; t(a,100)
        ; CASE 
           # bloc  4 #  M  valu=("m",345) ;
           UNION ( UNE , M , STRUCT ( CHAR  c, INT  d)) u:=valu ;
           M  d=("m", 333) ;  M  e:=("m", 334);
          ctrt:=   8
          ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105
) ; t(e, 334) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
          ; e:=("m",344) ; u
                 IN  (
             # bloc  5 #  M  f) : ((
            ctrt:=   9
            ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f,
 345) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
            ) , (
               # bloc  6 #
               M  f=("m", 355) ;  M  g:=("m", 356);
              ctrt:=  10
              ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 356) ; t(f,
 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
              ; FOR 
                 # bloc  7 #  k  FROM  (
                 M  g=("m", 466) ;  M  h:=("m", 467);
                ctrt:=  11
                ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 467) ; t(g, 466) ; t(
f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                ;0)  TO  nbcas
                    WHILE 
                   # bloc  8 #  valk+:=1 ;
                   M  g=("m", 366) ;  M  h:=("m", 367);
                  ctrt:=  12
                  ; ce(k,valk) ; t(j, 109) ; t(i, 108) ; t(h, 367) ; t(g, 366
) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                  ; TRUE    DO 
                     # bloc  9 #
                     M  h=("m", 377) ;  M  i:=("m", 378);
                    ctrt:=  13
                    ; ce(k,valk) ; t(j, 109) ; t(i, 378) ; t(h, 377) ; t(g, 366
) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                              ; CASE 
                       # bloc 10 #
                       M  i=("m", 388) ;  M  j:=("m", 389);
                      ctrt:=  14
                      ; ce(k,valk) ; t(j, 389) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ; k  IN 
                      #k=1# (
                         # bloc 11 #
                         M  j=("m", 199);
                        ctrt:=  15
                        ; ce(k,valk) ; t(j, 199) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                         # fin 11 #
                      ),
                      #k=2#  TO  (
                       M  j=("m", 299);
                      ctrt:=  16
                      ; ce(k,valk) ; t(j, 299) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;1)  DO 
                      ctrt:=  17
                      ; ce(k,valk) ; t(j, 389) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                       OD  ,
                      #k=3# (
                       M  j=("m", 399);
                      ctrt:=  18
                      ; ce(k,valk) ; t(j, 399) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ; HEAP   UNE ) := (
                       M  j=("m", 499);
                      ctrt:=  19
                      ; ce(k,valk) ; t(j, 499) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;"") ,
                      #k=4# (
                       M  j=("m", 599);
                      ctrt:=  20
                      ; ce(k,valk) ; t(j, 599) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;rune) [2 : (
                       M  j=("m", 699);
                      ctrt:=  21
                      ; ce(k,valk) ; t(j, 699) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;3 ) @ (
                       M  j=("m", 799);
                      ctrt:=  22
                      ; ce(k,valk) ; t(j, 799) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;1) ] ,
                      #k=5# (( UNE  x,y) VOID  : (
                       M  j=("m", 899);
                      ctrt:=  23
                      ; ce(k,valk) ; t(j, 899) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ))((
                       M  j=("m", 999);
                      ctrt:=  24
                      ; ce(k,valk) ; t(j, 999) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;""), SKIP ) ,
                      #k=6#  LOC  UNE  :=: (
                       M  j=("m",1099);
                      ctrt:=  25
                      ; ce(k,valk) ; t(j,1099) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ; HEAP  UNE ) ,
                      #k=7#   1+-(
                       M  j=("m",1199);
                      ctrt:=  26
                      ; ce(k,valk) ; t(j,1199) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;"") ,
                      #k=8# de OF de OF (
                       M  j=("m",1299);
                      ctrt:=  27
                      ; ce(k,valk) ; t(j,1299) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ; de) ,
                      #k=9#  UNE  (
                       M  j=("m",1399);
                      ctrt:=  28
                      ; ce(k,valk) ; t(j,1399) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ;"")     OUT 
                         # bloc 11 #
                        # k=0 #
                         M  j=("m",1499);
                        ctrt:=  29
                        ; ce(k,valk) ; t(j,1499) ; t(i, 388) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                         # fin 11 #
                       # fin 10 #
                     ESAC  ;
                     IF 
                       # bloc 10 #
                      ctrt:=  30
                      ; ce(k,valk) ; t(j, 109) ; t(i, 378) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                      ; k = 1  THEN 
                         # bloc 11 #
                         M  i=("m",  88) ;  M  j:=("m",  89);
                        ctrt:=  31
                        ; ce(k,valk) ; t(j,  89) ; t(i,  88) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                             ; CASE 
                           # bloc 12 #  UNE  u:= (
                          ctrt:=  32
                          ; ce(k,valk) ; t(j,  89) ; t(i,  88) ; t(h, 377) ; t(g
, 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                          ;"") ; u
                            IN  ( INT ) :  SKIP   OUSE 
                             # bloc 13 #
                             M  j=("m",  99);
                            ctrt:=  33
                            ; ce(k,valk) ; t(j,  99) ; t(i,  88) ; t(h, 377) ;
t(g, 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                            ; u  IN ( STRING ) : (
                            ctrt:=  34
                            ; ce(k,valk) ; t(j,  99) ; t(i,  88) ; t(h, 377) ;
t(g, 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                            ) # fin 13 #
                           # fin 12 #
                         ESAC  ;
                        ctrt:=  35
                        ; ce(k,valk) ; t(j,  89) ; t(i,  88) ; t(h, 377) ; t(g,
 366) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                         # fin 11 #
                       # fin 10 #
                     FI  ;
                    ctrt:=  36
                    ; ce(k,valk) ; t(j, 109) ; t(i, 378) ; t(h, 377) ; t(g, 366
) ; t(f, 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
                     # fin  9 #
                   # fin  8 #
                 # fin  7 #
               OD  ;
              ctrt:=  37
              ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 356) ; t(f,
 355) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
               # fin  6 #
            ) , (
            ctrt:=  38
            ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f,
 345) ; t(e, 344) ; t(d, 333) ; t(c, 322) ; t(b, 111) ; t(a,100)
            ) ) # fin  5 #
           # fin  4 #
         ESAC  ;
        (
           # bloc  4 #  UNE  u= (
          ctrt:=  39
          ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105
) ; t(e, 104) ; t(d, 323) ; t(c, 322) ; t(b, 111) ; t(a,100)
          ;"") ; u | ( INT ) :  SKIP  |
             # bloc  5 #
             M  d=("m", 433) ;  M  e:=("m", 434);
            ctrt:=  40
            ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f,
 105) ; t(e, 434) ; t(d, 433) ; t(c, 322) ; t(b, 111) ; t(a,100)
            ; (
               # bloc  6 # [ (
                 # bloc  7 #
                 M  e=("m", 444) ;  M  f:=("m", 445);
                ctrt:=  41
                ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(
f, 445) ; t(e, 444) ; t(d, 433) ; t(c, 322) ; t(b, 111) ; t(a,100)
                ;0 # fin  7 #
              ) : 0]  UNE  u ; LWB  u< UPB  u |  SKIP  |
                 # bloc  7 #
                 M  e=("m", 544) ;  M  f:=("m", 545);
                ctrt:=  42
                ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(
f, 545) ; t(e, 544) ; t(d, 433) ; t(c, 322) ; t(b, 111) ; t(a,100)
                ; (
                   # bloc  8 # 0 | 1, SKIP |:
                     # bloc  9 #
                     M  f=("m", 555) ;  M  g:=("m", 556);
                    ctrt:=  43
                    ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 556
) ; t(f, 555) ; t(e, 544) ; t(d, 433) ; t(c, 322) ; t(b, 111) ; t(a,100)
                    ;2 |  SKIP  , (
                    ctrt:=  44
                    ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 556
) ; t(f, 555) ; t(e, 544) ; t(d, 433) ; t(c, 322) ; t(b, 111) ; t(a,100)
                    ) # fin  9 #
                   # fin  8 #
                ) ;
                ctrt:=  45
                ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(
f, 545) ; t(e, 544) ; t(d, 433) ; t(c, 322) ; t(b, 111) ; t(a,100)
                 # fin  7 #
               # fin  6 #
            ) ;
            ctrt:=  46
            ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f,
 105) ; t(e, 434) ; t(d, 433) ; t(c, 322) ; t(b, 111) ; t(a,100)
             # fin  5 #
           # fin  4 #
        ) ;
        ctrt:=  47
        ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105
) ; t(e, 104) ; t(d, 323) ; t(c, 322) ; t(b, 111) ; t(a,100)
         # fin  3 #
       # fin  2 #
     # fin  1 #
   FI  ;
  ctrt:=  48
  ; ce(k,999) ; t(j, 109) ; t(i, 108) ; t(h, 107) ; t(g, 106) ; t(f, 105) ; t(e,
 104) ; t(d, 103) ; t(c, 102) ; t(b, 101) ; t(a,100)
   # fin  0 #

;print((ctr," tests ",(ctr=vf|"ok"|"error"))))
