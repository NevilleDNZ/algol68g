<!-- Header -->
<html>
<head>
<title>Algol 68 Genie</title>
<meta name="Keywords" content="algol,algol68,68,algol-68,algol68g,algol68-g,a68g,a68-g,68g,genie,interpreter">
<meta http-equiv="Content-Style-Type" content="text/css"; charset=ISO-8859-1">
<style type="text/css">
a:link    {color: blue; text-decoration: underline;}
a:visited {color: blue; text-decoration: underline;}
a:active  {color: blue; text-decoration: underline;}
p {font-size: 10pt; font-family: arial, sans-serif;}
u {font-size: 10pt; font-family: arial, sans-serif;}
dd {font-size: 10pt; font-family: arial, sans-serif;}
h1 {font-size: 14pt; font-family: arial, sans-serif;}
h2 {font-size: 12pt; font-family: arial, sans-serif;}
h3 {font-size: 10pt; font-family: arial, sans-serif;}
h4 {font-size: 10pt; font-family: arial, sans-serif;}
td {font-size: 10pt; font-family: arial, sans-serif;}
ul {font-size: 10pt; font-family: arial, sans-serif;}
body {font-size: 10pt; font-family: arial, sans-serif;}
tt {font-size: 10pt; font-family: "courier new", monospace;}
code {font-size: 10pt; font-family: "courier new", monospace;}
pre {font-size: 10pt; font-family: "courier new", monospace;}
</style>
</head>

<body bgcolor="white">

<table width="100%" border=0 cellspacing=0 cellpadding=0>
<td width="100%" background="lines.gif">
<img src="lines.gif" align=right>
<small>
<b>Documentation for Algol 68 Genie Mark 11.1</b>
</small>
</td>
</table>


<table width="100%" border=0 cellspacing=0 cellpadding=0>
<td width="50%" valign=top bgcolor="white">
<br>
<h2>Example: Fast Fourier Transform</h2>
</td>
<td width="30%" valign=top bgcolor="white">
<img src="algol68.gif">
</td>
<td width="5%" valign=top bgcolor="white">
</td>
<td width="15%" valign=top bgcolor="white">
<!-- Navigation bar -->
<table border="0" cellspacing="0" width="100%">
<tr>
<td background="lines.gif">
<p>
<a href="algol.html"><small><b>A68G Home</b></small></a>
<p>
<a href="contents.html"><small><b>Documentation</b></small></a><br>
<p>
<a href="report_contents.html"><small><b>Revised Report</b></small></a>
<p>
<a href="algol.html#obtaining"><small><b>Downloads</b></small></a>
</td>
</tr>
</table>
<!-- End navigation bar -->
</td>
</table>

<pre>
PROC fft = (REF () LONG COMPLEX f, INT dir) VOID:

     IF COMMENT 
           Unnormalised Fast Fourier Transform in recursive form:
              F (k) = F even (k) + exp (2 pi i k / n) * F odd (k).
           Parameter dir = +- 1 determines direction of the transform. 
           Assume that the lower bound of f is zero, and that its 
           length is a power of 2.
        COMMENT
     
        INT length = UPB f + 1;
        length > 1
     THEN INT middle = length % 2;
          # Calculate transforms at sublevels #
          (0 .. middle - 1) LONG COMPLEX f even, f odd;
          FOR i FROM 0 TO middle - 1
          DO f even (i) := f (2 * i); 
             f odd (i) := f (2 * i + 1)
          OD;
          (fft (f even, dir), fft (f odd, dir));
          # Calculate transform at this level #
          FOR k FROM 0 TO middle - 1
          DO LONG REAL phi = dir * 2 * long pi * k / length;
             LONG COMPLEX factor = long cos (phi) I long sin (phi) * f odd (k);
             f (k) := f even (k) + factor; 
             f (k + middle) := f even (k) - factor
          OD
     FI;

# A trivial application for `fft' - calculate power spectrum #

INT n = 32;
(0 : n - 1) LONG COMPLEX f, (0 : n % 2 - 1) LONG REAL power;

FOR i FROM 0 TO n - 1
DO f (i) := 0;
   FOR j BY 2 TO n % 2 - 1
   DO f (i) +:= long sin (2 * long pi * i * j / n) / j
   OD
OD;

fft (f, 1);

FOR i FROM 0 TO n % 2 - 1
DO power (i) := ABS f (i) / (n % 2)
OD;

printf (($lg$, power))
</pre>

<!-- Footer -->
<p>
<div style="border: 1px solid red">
<table cellpadding=6>
<tr>
<td>
<small>
Copyright &copy; 2001-2008 J. Marcel van der Veer.<br>
Algol 68 Genie Mark 11.1 (March 2008)
</small>
</td>
</tr>
</table>
</div>
</body>
</html>

